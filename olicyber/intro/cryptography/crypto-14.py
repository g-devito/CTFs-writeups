#!/usr/bin/env python3
from Crypto.Hash import SHA3_384, HMAC, SHA224
from Crypto.PublicKey import DSA
import Crypto.Random
from Crypto.Util import number

# sha3-384 hashing
msg = b'hash_me_pls'
h_obj = SHA3_384.new()
h_obj.update(msg)
hash = h_obj.hexdigest()

print(hash)
print()

# HMAC (Hash Message Auth Code) con SHA-224
key= bytes.fromhex('5c0fd8efc1cf1fdfcb1b25aa5994d8341726d6664e42f3546b28cb3af5fc2dd4')
msg = 'La mia integrità è importante!'.encode('utf-8')
HMAC = HMAC.new(key, msg, digestmod=SHA224).hexdigest()

print(HMAC)
print()
# DSA key
key = bytes.fromhex('3082025c0201003082023506072a8648ce380401308202280282010100f930978055065edd34e8055930b6768274e8fb4e888dbdd3acbb88985c133c468561e5dda5e5932df7ba4daeba2883ff8a87500b9f60b9ad6cb442691eace17cc77dfe6d4a8876df789a9b40be655c21299596987ccdec8f13c7440e75dcc3cb8ee54d64a5c2d877bf0daaa08e4b041efc31b9a89ab649190fbc0d4f159f65c3698865569e8d4e716f45ccd4da639336f4e30ba3a9704503313f5bcbd9ad157b67d93dccbc7fbdf4d49f409caa79efbbcc0efcf47c6885b9da5688ac68c859a9f484e4e664e1f7a5db8f948f926c072864823756d67cac898e99d5ce47a14ca43cdb042a57046a8fdab8ede821e1327c4f9cabcaabb6042527784aefbef2e17f021d00c91c16c3fa8f5b833cbcc7c96809cb4c15f39b40a16c25940389280b0282010026367e0f77bf5a0c04cd281234f46e5386dd69e10f0e227cec94778de0645d704049565143c34c6006b5c847d8afaaae0c8685d353599230ec757064a3fcfe7f35b2b16ab8e6f371c13f33009f9b153b2655608edc745c6cb69e9738562c5f62552017674dcdc3e34ac24bf64e1f476d254acfc10d75e584f09838d87e5184d1a1fd977cfbc4ca33dd828a7207fc75bae26d876511040adea165da06b14da4c99d999b36f4889009a977d078a6c7385f88a96cb33c2b312dfe110c88d7daa9a15b05fe0376e33b465308c17004684a50b67e783b0631f5788021edd750c02e6203ce82395676c76cb0ee8f01e8dcc0da64204f58cd8f568745f5ca22d6818443041e021c5d9fb60d91b2c4a999f29c9bc6cc128020bd10ff1923d9b3a8d67b00')
key = DSA.import_key(key)
print(key.x)
print()
print(key.q)
print()
print(key.g)
print()

print(number.getPrime(1049))
print()
p = 108252618763704169491160790554681279950234007498557317296016609153776822543559668329296152188048128149840357758452080144617979647659875051402098388548135126520690402330837781992443555210045507453821066069375525702295903486418490358697038354185515844467433424185962061476439714645895722365305457645528996266023

print(number.isPrime(p))
